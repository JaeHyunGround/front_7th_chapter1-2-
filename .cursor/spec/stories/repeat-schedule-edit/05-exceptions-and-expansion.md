---
epic: repeat-schedule-edit
test_suite: 반복 일정 편집 - 예외 처리와 확장
---

# Story: 예외 처리 저장 규칙 및 확장 반영

## 개요

단일 분리 시 시리즈 `exceptions`에 날짜가 추가되어 확장(expand)에서 제외되고, 동일 날짜의 단일 이벤트만 노출되는지 검증합니다.

## Epic 연결

- **Epic**: 반복 일정 수정 (단일/전체 선택)
- **Epic 파일**: `.cursor/spec/epics/repeat-schedule-edit.md`
- **검증 포인트 출처**: 예상 동작 섹션 5) 예외 처리 저장 규칙

## 테스트 구조 및 범위

- **테스트 스위트 (Describe Block):** '반복 일정 편집 - 예외 처리와 확장'
  - **테스트 케이스 1:** 예외 날짜가 시리즈에 한 번만 등록(중복 방지)
  - **테스트 케이스 2:** 확장 결과에서 예외 날짜 인스턴스가 제외됨
  - **테스트 케이스 3:** 동일 날짜의 단일 이벤트 1건만 노출됨

## 검증 포인트 (Given-When-Then)

```
Given: repeat.id = "r-123" 시리즈, 2025-11-05 인스턴스 편집 → 단일 수정
When: 저장 완료 후 범위 확장(expandEventsForRange)
Then: 2025-11-05는 시리즈 확장에서 제외되고, 단일 이벤트 1건만 노출됨
```

## 테스트 데이터

| 필드              | 값            | 비고                         |
| ----------------- | ------------- | ---------------------------- |
| repeat.exceptions | ['2025-11-05']| 예외 날짜(중복 없음)         |
| date              | '2025-11-05'  | 단일 이벤트 표시 대상        |

## 기술 참고사항

- `RepeatInfo.exceptions?: string[]` 사용
- 확장 로직에서 exceptions 포함 날짜는 skip 되어야 함


